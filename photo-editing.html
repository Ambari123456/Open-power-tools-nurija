<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Basic Image Repair Tool</title>
  <style>
    canvas { border: 1px solid #ccc; margin-top: 20px; }
    .controls { margin-top: 20px; }
  </style>
</head>
<body>

<h2>Upload and Repair Image</h2>
<input type="file" id="upload" accept="image/*">
<br>
<canvas id="canvas" width="400" height="400"></canvas>

<div class="controls">
  <button onclick="increaseContrast()">Increase Contrast</button>
  <button onclick="increaseBrightness()">Increase Brightness</button>
  <button onclick="grayscale()">Grayscale</button>
  <button onclick="clearCanvas()">Clear</button>
</div>

<script>
  const upload = document.getElementById('upload');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  let img = new Image();

  upload.addEventListener('change', (e) => {
    const reader = new FileReader();
    reader.onload = function(event) {
      img.onload = () => {
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0);
      };
      img.src = event.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });

  function adjustImage(adjustFn) {
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;
    adjustFn(data);
    ctx.putImageData(imageData, 0, 0);
  }

  function increaseContrast() {
    adjustImage(data => {
      const factor = (259 * (128 + 100)) / (255 * (259 - 100));
      for (let i = 0; i < data.length; i += 4) {
        data[i] = factor * (data[i] - 128) + 128;
        data[i + 1] = factor * (data[i + 1] - 128) + 128;
        data[i + 2] = factor * (data[i + 2] - 128) + 128;
      }
    });
  }

  function increaseBrightness() {
    adjustImage(data => {
      for (let i = 0; i < data.length; i += 4) {
        data[i] += 20;     // red
        data[i + 1] += 20; // green
        data[i + 2] += 20; // blue
      }
    });
  }

  function grayscale() {
    adjustImage(data => {
      for (let i = 0; i < data.length; i += 4) {
        const avg = (data[i] + data[i+1] + data[i+2]) / 3;
        data[i] = data[i+1] = data[i+2] = avg;
      }
    });
  }

  function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
</script>

</body>
</html>
